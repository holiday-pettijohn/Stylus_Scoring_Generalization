# Library Functions

## compare_genes.py

Gets heuristic and exhaustive scores for any given algorithm. Contains a specific function to obtain exhaustive scores

`matchError(heuristic_scores, standard_scores)`: retrieves the (log) ratio of heuristic and canonical scores

Input:

heuristic_scores [Array (float)]: list of scores obtained from a heuristic algorithm

standard_scores [Array (float)]: list of scores obtained from a canonical score source, such as exhaustive search or the original gene file

Output:

scores [Array (float)]: list of log ratios between the standard and heuristic score. Higher values indicate more error.

`getScores(ref_char, data_dir)`: Calculates scores for a set of gene characters against a given reference with a heuristic algorithm. Files from the directory specified with gene data are read in a deterministic order (same files = same order)

Input:

`algorithm(stroke_geometry, reference_geometry, stroke_fractional_distance, reference_fractional_distance)`: A function with the below signature. Takes stroke geometry and archetype geometry and scores the stroke against the archetype

- Algorithm arguments:

- stroke_geometry [Array[Array] (float)]: List of the strokes from the gene instance

- reference_geometry [Array[Array] (float)]: List of the strokes from the archetype

- stroke_fractional_distance [Array (float)]: List of fractional distances (a.k.a. progress percentages) for each stroke in the gene instance

- reference_fractional_distance [Array (float)]: List of fractional distances (a.k.a. progress percentages) for each stroke in the reference

ref_char [string]: UTF-8 name of the archetype in question

data_dir [string]: Directory with the gene files for testing

Output:

heuristic_scores [Array (float)]: The scores returned from the given algorithm for each of the genes in the directory

heuristic_alignments [Array[Array] (int)]: Alignments which the algorithm returned
marks [Array (bool)]: Whether or not each respective score has a mark, which is an additional stroke which has no counterpart in the archetype

`exhaustiveScores(ref_char, data_dir, timed = False, save = False, file_prefix = "")`: Calculates the Stylus score for the best matching between a given archetype and the gene files in a given directory using exhaustive search. This can take a while, especially for high stroke count archetypes.

Input:

ref_char [string]: UTF-8 name of the archetype in question

data_dir [string]: Directory with the gene files for testing

timed [bool]: Whether to print the time taken to generate exhaustive matchings

save [bool]: Whether to save the results of exhaustive generation to a fixed directory

file_prefix [string] = "": File prefix which will be prepended to generated files if save is True

Output:

exhaustive_scores [Array (float)]: List of Stylus scores for the best matchings between the given archetype and file. Files are iterated in a constant order which can be obtained by running `sorted(files)` on the list of files in question.

## exhaustive.py

Functions for dealing with exhaustive comparisons between Stylus genomes

`computeExhaustive(ref_char, f_read, data_dir, exhaust_dir = "Exhaustive", prog_interval = 100, save = True, xml_dir = "GenXml/Exhaustive", save_file = "")`

Obtains the best Stylus score for a set of genes against one archetype using exhaustive search to find the best alignment

Input:

ref_char [string]: UTF-8 name of the archetype in question

f_read [Array (string)]: List of files within data_dir to search for optimal alignments

data_dir [string]: Directory with the gene files for testing

exhaust_dir [string]: Directory to save exhaustive data to, if data is to be saved and save_file is not specified

prog_interval [int]: Number of genes after which to print a progress update

save [bool]: Whether to save the results of the search to a file

xml_dir [string]: Directory to place xml files generated by exhaustive search

save_file [string]: File to write exhaustive scores to, if scores are to be saved

Output:

exhaustive_scores [Generator[Array, Array] (float, int), ]: Generator for the series of optimal scores for the genes against the given archetype

`computeExhastiveAlign(ref_char, f_read, data_dir, exhaust_dir = "Exhaustive", prog_interval = 100, save = True, xml_dir = "GenXml/Exhaustive", save_file = "")`

Obtains the alignment which obtains the best Stylus score for a set of genes against one archetype using exhaustive search

Input: Identical to the above (computeExhaustive)

Output:

exhaustive_scores [Generator[Array, Array] (float, int), ]: Generator for the series of optimal scores for the genes against the given archetype, paired with the alignments associated with said scores

`readExhaustive`

Reads previously calculated and saved exhaustive score/alignment data

Input:

ref_char [string]: UTF-8 name of the archetype in question

f_name [string]: Name of the gene file associated with the data to be read

exhaust_dir [string]: Directory to read exhaustive data from, if save_file is not specified

save_file [string]: File to read exhaustive scores from. If not specified, this will be inferred from the above arguments

Output:

data_read [Array (float)]: List of scores read from the indicated files

`exhaustScore`

Obtains the best Stylus score for one gene against one archetype using exhaustive search to find the best alignment

Input:

ref_char [string]: UTF-8 name of the archetype in question

f_name [string]: Name of the gene file on which to preform exhaustive search

data_dir [string]: Directory with the gene file for testing

exhaust_dir [string]: Directory to save exhaustive data to, if data is to be saved and save_file is not specified

save [bool]: Whether to save the results of the search to a file

file_prefix [string] = "": File prefix which will be prepended to generated files if save is True

Output:

exhaust_score [float]: Maximum score obtained for the gene against the given archetype using exhaustive search

exhaustive_scores [Generator[Array, Array] (float, int), ]: Generator for the series of optimal scores for the genes against the given archetype

`exhaustScoreAlignment`

Obtains the alignment which obtains the best Stylus score for one gene against one archetype using exhaustive search

Input: Identical to the above (exhaustScore), without file_prefix

Output:

exhaust_align [Array (int)]: Alignment with which to obtain the optimal score for the given gene against the given archetype

## load_strokes.py

## score_strokes.py

## xml_parse.py

# Notebooks


